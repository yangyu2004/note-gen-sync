# 谷粒商城环境配置

## 1.Vagrant环境配置

![image.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%2Fassets%2F97889f3f-97f5-4492-9929-ad614bae06dd.png)

![QQ_1759375450524.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%2Fassets%2F06d66945-9954-402d-9c43-882551dc356a.png)

根据自己电脑的芯片配置选择下载文件（我的是Intel的）

![image.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%2Fassets%2F1f8675d5-81ac-4293-bdc4-cc0e918f2fa0.png)

我安装的是中科大镜像的Centos Stream 9

中科大镜像网址如下

> https://mirrors.ustc.edu.cn/centos-cloud/centos/9-stream/x86_64/images/

要选择vagrant专用的.box格式的文件

文件名要类似

> `CentOS-Stream-Vagrant-9-20241118.0.x86_64.vagrant-virtualbox.box`

包含 `Vagrant`   `virtualbox` `.box` 关键字 表示适用于 `Vagrant`的

1. 删除可能残留的旧配置文件（避免冲突）

> del vagrantfile

2. 使用中科大镜像链接初始化

> vagrant vagrant init centos-stream9 https://mirrors.ustc.edu.cn/centos-cloud/centos/9-stream/x86_64/images/CentOS-Stream-Vagrant-9-20241118.0.x86_64.vagrant-virtualbox.box

3. 启动虚拟机

> vagrant up

## 2.VirtualBox

![image.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%2Fassets%2F548910b7-5fad-47e5-bb09-484c9eefd496.png)

![image.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%2Fassets%2F16679b9a-1481-4014-834f-3e840ce0d51f.png)

安装过程略

## 3.虚拟机环境配置

win+R cmd

> ipconfig

![image.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%E8%B0%B7%E7%B2%92%E5%95%86%E5%9F%8E%2Fassets%2F9c940f24-ae31-47f3-8b02-0e8ea358e81a.png)

这就是CPU虚拟化的 IPV4地址

在目录

> "C:\Users\yy\Vagrantfile" 下设置 Vagrantfile 的配置

![image.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%E8%B0%B7%E7%B2%92%E5%95%86%E5%9F%8E%2Fassets%2Fbb485347-7e9b-4f31-9424-2328827c1da3.png)

之后重启虚拟机

> vagrant reload

查看虚拟机的ip配置

> ip addr

![image.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%E8%B0%B7%E7%B2%92%E5%95%86%E5%9F%8E%2Fassets%2F94d1ee34-2262-429c-8c79-44c553d2cd2d.png)

ping测试

![image.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%E8%B0%B7%E7%B2%92%E5%95%86%E5%9F%8E%2Fassets%2F3498ba8f-0179-4605-8a4c-f0fa3e06294c.png)

![image.png](http://asset.localhost/C%3A%5CUsers%5Cyy%5CAppData%5CRoaming%5Ccom.codexu.NoteGen%2Farticle%2F%E8%B0%B7%E7%B2%92%E5%95%86%E5%9F%8E%2Fassets%2Fd9eb3939-f3e8-422a-99cc-9f214258e0f0.png)

配置成功

## 4.安装Docker

Docker官网

> https://docs.docker.com/engine/install/centos/

### 1.卸载系统之前的Docker

> sudo dnf remove docker
> docker-client
> docker-client-latest
> docker-common
> docker-latest
> docker-latest-logrotate
> docker-logrotate
> docker-engine

### 2.设置仓库

[Set up the repository](https://docs.docker.com/engine/install/centos/#set-up-the-repository)

> sudo dnf -y install dnf-plugins-core
> sudo dnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

### 3.安装Docker

```console
 sudo dnf install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

### 4.设置Docker服务开机自启动且立即启动Docker

```
sudo systemctl enable --now docker
```

### 5.配置Docker阿里云镜像加速

#### 1.创建 Docker 配置目录

```bash
sudo mkdir -p /etc/docker
```

#### 2.创建并写入加速器配置文件

```bash
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://docker.1ms.run"]
}
EOF
```

#### 3.重新加载系统服务配置

```bash
sudo systemctl daemon-reload
```

#### 4.重启 Docker 服务

```bash
sudo systemctl restart docker
```

## 6.Docker安装MySQL

### 1.下载镜像文件

```
docker pull mysql:5.7
```

### 2.创建实例并启动

```
sudo docker run -p 3306:3306 --name mysql \
-v /mydata/mysql/log:/var/log/mysql \
-v /mydata/mysql/data:/var/lib/mysql \
-v /mydata/mysql/conf:/etc/mysql/config.d \
-e MYSQL_ROOT_PASSWORD=root \
-d mysql:5.7
```

### 3.


```
vi /mydata/mysql/conf/my.conf

[client]
default-character-set=utf8
[mysql]
default-character-set=utf8
[mysqld]
init_connect='SET collation_connection = utf8_unicode_ci'
init_connect='SET NAMES utf8'
character-set-server=utf8
collation-server=utf8_unicode_ci
skip-character-set-client-handshake
skip-name-resolve

:wq 退出

docker restart mysql
```
